# API JSON 路径 配置帮助

## 这是什么？

如果你要使用的背景图 API 不返回图片，而是返回 JSON（[什么是 JSON ？](https://developer.mozilla.org/zh-CN/docs/Learn/JavaScript/Objects/JSON)），你需要查看本帮助文档。

如上面教程所述，JSON 通过字符串来表达一个对象，而背景图 API 在返回的 JSON 内容里会包含图片的直链，以及图片的一些其他信息。本插件只需要其中的图片直链信息。

怎么获取图片直链呢？那就要通过“路径”去访问返回的 JSON 对象里的字段了。

在阅读下面内容之前，你最好拥有一些基础的编程知识，以帮助你更好地理解。



## 如何填写 JSON 路径

以一个 JSON 对象为例子（假设下面的文本就是 API 的返回值）

```json
{
  a: {
    b: "d",
    c: ["e", "f"],
    'dot.dot': 'key'
  }
}
```

### 访问字段

例如你想得到`d`，那么 JSON 路径是`a.b`，很简单明了，第一个是`a`，然后通过一个点访问他的子字段`b`，最终结果就是`d`。

### 访问数组

例如你想得到`e`，那么 JSON 路径是`a.c.0`，与字段类似，但需要通过数组下标来访问数组里面的内容，数组下标也是通过点号来链接的。需要注意的是，数组下标是从0开始算的。例如，你想访问第一个元素，你需要写0，第二个元素则是1。

### 访问包含点号的字段

如果一个字段名称包含点（"."），例如上面 JSON 对象中的 `dot.dot` ，这个点就包含在名称里。目前此类字段暂不支持访问。一般来说，也不会出现这种情况。



如果你想知道完整的用法，请参考[object-path npm包帮助页](https://www.npmjs.com/package/object-path)。



## 一个实际的例子

假设你使用[https://api.lolicon.app/setu](https://api.lolicon.app/setu)这个API，他的某次返回值如下：

```json
{
    "code": 0,
    "msg": "",
    "count": 1,
    "data": [
        {
            "pid": 104443997,
            "p": 0,
            "uid": 33955881,
            "title": "ラ・プルマ",
            "author": "Eπ",
            "r18": false,
            "width": 759,
            "height": 1075,
            "tags": [
                "R-18",
                "ラ・プルマ(アークナイツ)",
                "羽毛笔（明日方舟）",
                "アークナイツ",
                "明日方舟",
                "陰毛",
                "阴毛",
                "水着",
                "泳装",
                "白ビキニ",
                "白色比基尼"
            ],
            "url": "https://i.pixiv.re/img-original/img/2023/01/12/00/55/21/104443997_p0.jpg"
        }
    ]
}
```

原图直链很明显在最下面，那么你需要输入的 JSON 路径是 `data.0.url` 。先访问到 `data` 字段，然后 `data` 字段是一个数组（用方括号包裹了），所以你需要访问他的第一个元素（这个API一般情况下只会返回一个，所以访问第一个元素即可），所以就是 `data.0`，然后他的第一个元素的 `url` 字段是原图直链，所以最终你填写 `data.0.url` 即可。

若出现复杂返回的 JSON ，而你又不会处理，可以发 ISSUE 。